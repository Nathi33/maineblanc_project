{% extends "core/base.html" %}

{% load static i18n custom_filters %}

{% block title %}{% trans "Tarifs | Camping Le Maine Blanc" %}{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{% static 'css/rates.css' %}" />
{% endblock %}

{% block content %}
<section class="container py-5" role="region" aria-labelledby="rates-title">

    <div class="container-title">
        <img src="{% static 'pictures/peindre.png' %}" alt="" loading="lazy" class="img-deco-left" />
        <h1 id="rates-title" class="title-rates">{% trans "Tarifs" %}</h1>
        <img src="{% static 'pictures/peindre.png' %}" alt="" loading="lazy" class="img-deco-right" />
    </div>

    <!-- Prices -->
    <div class="rates-section mb-5">
        <h2 class="under-title-rates">{% trans "Tarifs pour l'année" %} {{ other_prices.current_year }}</h2>
        <p class="small text-muted mb-0">{% trans "Taxe de séjour à compter du" %} {{ other_prices.tourist_tax_date|format_date_by_locale }} : {{ other_prices.price_tourist_tax }}€ {% trans "par personne/nuit (incluse dans le prix)" %}</p>
        <p class="small text-muted">{% trans "Tous les prix sont TTC." %}</p>

        <div class="table-wrapper">
            <table class="table table-bordered align-middle">
                <thead class="table-light text-center align-middle">
                    <tr>
                        <th>{% trans "Type d’hébergement" %}</th>
                        <th>{% trans "Basse Saison" %}<br>{% trans "du" %} {{ season_info.low_season_start|format_date_by_locale }} {% trans "au" %} {{ season_info.low_season_end|format_date_by_locale }} </th>
                        <th>{% trans "Moyenne Saison" %}<br>{% trans "du" %} {{ season_info.mid_season_start_1|format_date_by_locale }} {% trans "au" %} {{ season_info.mid_season_end_1|format_date_by_locale }} <br>{% trans "et du" %} {{ season_info.mid_season_start_2|format_date_by_locale }} {% trans "au" %} {{ season_info.mid_season_end_2|format_date_by_locale }} </th>
                        <th>{% trans "Haute Saison" %}<br>{% trans "du" %} {{ season_info.high_season_start|format_date_by_locale }} {% trans "au" %} {{ season_info.high_season_end|format_date_by_locale }} </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Camping-car -->
                    <tr class="text-center">
                        <td class="container-type">
                            <span class="under-title">{% trans "Camping-car (1-2 pers.)" %}</span><br>
                            <div>
                                <img src="{% static 'pictures/elec.png' %}" alt="{% trans "Electricité" %}" loading="lazy" class=" logo-infos">
                                <span class="full-text">{% trans "Avec électricité" %}</span>
                                <span class="short-text">{% trans "Avec élec." %}</span>
                                <br>
                            </div>
                            <div>
                                <img src="{% static 'pictures/no-elec.png' %}" alt="{% trans "Pas d'électricité" %}" loading="lazy" class="logo-infos">
                                <span class="full-text">{% trans "Sans électricité" %}</span>
                                <span class="short-text">{% trans "Sans élec." %}</span>
                            </div>
                        </td>
                        
                        {# --- Low season --- #}
                        <td class="align-bottom">
                            {% for p in grouped_prices.camping_car %}
                                {% if p.season == "low" %}
                                    {{ p.price_2_persons_with_electricity }}€<br>
                                    {{ p.price_2_persons_without_electricity }}€
                                {% endif %}
                            {% endfor %}
                        </td>

                        {# --- Mid season --- #}
                        <td class="align-bottom">
                            {% for p in grouped_prices.camping_car %}
                                {% if p.season == "mid" %}
                                    {{ p.price_2_persons_with_electricity }}€<br>
                                    {{ p.price_2_persons_without_electricity }}€
                                {% endif %}
                            {% endfor %}
                        </td>

                        {# --- High season --- #}
                        <td class="align-bottom">
                            {% for p in grouped_prices.camping_car %}
                                {% if p.season == "high" %}
                                    {{ p.price_2_persons_with_electricity }}€<br>
                                    {{ p.price_2_persons_without_electricity }}€
                                {% endif %}
                            {% endfor %}
                        </td>
                    </tr>


                    <!-- Caravan / Converted Van -->
                    <tr class="text-center">
                        <td>
                            <span class="under-title">{% trans "Caravane / Fourgon / Van" %}</span><br>
                            <div>
                                <div>
                                    <img src="{% static 'pictures/elec.png' %}" alt="{% trans "Electricité" %}" loading="lazy" class=" logo-infos">
                                        <span class="full-text">{% trans "Avec électricité" %}</span>
                                        <span class="short-text">{% trans "Avec élec." %}</span>
                                        <br>
                                </div>
                                <div>
                                    <img src="{% static 'pictures/no-elec.png' %}" alt="{% trans "Pas d'électricité" %}" loading="lazy" class="logo-infos">
                                    <span class="full-text">{% trans "Sans électricité" %}</span>
                                    <span class="short-text">{% trans "Sans élec." %}</span>
                                </div>
                            </div>
                        </td>
                        <td class="p-0 price-wrapper">
                            <table class="w-100 text-center">
                                <tr>
                                    <td>
                                        <span class="number-people">
                                            {% trans "1 pers." %}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="number-people">
                                            {% trans "2 pers." %}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    {# --- Low season --- #}
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "low" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "low" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>

                        <!-- Mid Season -->
                        <td class="p-0">
                            <table class="w-100 text-center">
                                <tr>
                                    <td><span class="number-people">{% trans "1 pers." %}</span></td>
                                    <td><span class="number-people">{% trans "2 pers." %}</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "mid" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "mid" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>

                        <!-- High Season -->
                        <td class="p-0">
                            <table class="w-100 text-center">
                                <tr>
                                    <td><span class="number-people">{% trans "1 pers." %}</span></td>
                                    <td><span class="number-people">{% trans "2 pers." %}</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "high" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.caravan %}
                                            {% if p.season == "high" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                        

                    <!-- Tent / Car Tent -->
                    <tr class="text-center">
                        <td>
                            <span class="under-title">{% trans "Tente / Voiture Tente" %}</span><br>
                            <div>
                                <img src="{% static 'pictures/elec.png' %}" alt="{% trans "Electricité" %}" loading="lazy" class=" logo-infos">
                                <span class="full-text">{% trans "Avec électricité" %}</span>
                                <span class="short-text">{% trans "Avec élec." %}</span>
                                <br>
                            </div>
                            <div>
                                <img src="{% static 'pictures/no-elec.png' %}" alt="{% trans "Pas d'électricité" %}" loading="lazy" class="logo-infos">
                                <span class="full-text">{% trans "Sans électricité" %}</span>
                                <span class="short-text">{% trans "Sans élec." %}</span>
                            </div>
                        </td>

                        <!-- Low Season -->
                        <td class="p-0">
                            <table class="w-100 text-center">
                                <tr>
                                    <td><span class="number-people">{% trans "1 pers." %}</span></td>
                                    <td><span class="number-people">{% trans "2 pers." %}</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "low" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "low" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>

                        <!-- Mid Season -->
                        <td class="p-0">
                            <table class="w-100 text-center">
                                <tr>
                                    <td><span class="number-people">{% trans "1 pers." %}</span></td>
                                    <td><span class="number-people">{% trans "2 pers." %}</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "mid" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "mid" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>

                        <!-- High Season -->
                        <td class="p-0">
                            <table class="w-100 text-center">
                                <tr>
                                    <td><span class="number-people">{% trans "1 pers." %}</span></td>
                                    <td><span class="number-people">{% trans "2 pers." %}</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "high" %}
                                                {{ p.price_1_person_with_electricity }}€<br>
                                                {{ p.price_1_person_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for p in grouped_prices.tent %}
                                            {% if p.season == "high" %}
                                                {{ p.price_2_persons_with_electricity }}€<br>
                                                {{ p.price_2_persons_without_electricity }}€
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>


                    <!-- Workers -->
                    <tr>
                        <td class="text-center">
                            <span class="under-title">{% trans "Ouvriers" %}</span><br>
                            <span class="small">({% trans "Tarifs comprenant l'électricité" %})</span>
                        </td>
                        <td colspan="3" class="text-center">
                            <div class="d-inline-block text-start">
                                {% for wp in worker_prices %}
                                    {% if wp.booking_type == "caravan" %}
                                        {% trans "Caravane" %} : {{ wp.worker_week_price }}€ / {% trans "jour" %} <br>
                                    {% elif wp.booking_type == "tent" %}
                                        {% trans "Tente" %} : {{ wp.worker_week_price }}€ / {% trans "jour" %} <br>
                                    {% endif %}
                                {% endfor %}

                                {% for wp in worker_prices %}
                                    {% if wp.booking_type == "other" %}
                                        {% trans "Emplacement pour le week-end (si non libéré)" %} : 
                                        <ul class="list-board mb-0">
                                            {% if wp.weekend_price_without_electricity %}
                                                <li>{{ wp.weekend_price_without_electricity }}€ ({% trans "sans électricité" %})</li>
                                        {% endif %}
                                        {% if wp.weekend_price_with_electricity %}
                                            <li>{{ wp.weekend_price_with_electricity }}€ ({% trans "avec électricité" %})</li>
                                        {% endif %}
                                        </ul>
                                    {% endif %}
                                {% endfor %}
                                </ul>
                            </div>
                        </td>
                    </tr>

                    <!-- Supplements -->
                    <tr >
                        <td class="text-center">
                            <span class="under-title">{% trans "Suppléments emplacements" %}</span>
                        </td>
                        <td colspan="3" class="text-center">
                            <div class="d-inline-block text-start">
                                {% for item in supplements %}
                                    {{ item.label }} : {{ item.price }}€<br>
                                {% endfor %}
                                {% if visitor_prices %}
                                    <span>{% trans "Visiteur : " %}</span>  
                                    <ul class="list-board mb-0">
                                        {% for visitor in visitor_prices %}
                                            <li>{{ visitor.price }}€ : {{ visitor.label }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- Mobil-homes prices -->
    <div class="table-wrapper">
        <table class="table table-bordered align-middle text-center caption-top" aria-label="{% trans 'Tarifs des Mobil-homes' %}">
            <caption>{% trans 'Tarifs par type de mobil-home et saison' %}</caption>
            <thead>
                <tr>
                    <th scope="col" class="align-middle text-center">{% trans "Mobil-home" %}</th>
                    <th scope="col" class="align-middle text-center">{% trans "A la nuitée" %}
                        <br>
                        <small>{% trans "(Uniquement en basse et moyenne saison)" %}</small>
                    </th>
                    <th scope="col" class="align-middle text-center">{% trans "Basse Saison" %}<br>{% trans "du" %} {{ season_info.low_season_start|format_date_by_locale }} {% trans "au" %} {{ season_info.low_season_end|format_date_by_locale }}</th>
                    <th scope="col" class="align-middle text-center">{% trans "Moyenne saison" %}<br>{% trans "du" %} {{ season_info.mid_season_start_1|format_date_by_locale }} {% trans "au" %} {{ season_info.mid_season_end_1|format_date_by_locale }} <br>{% trans "et du" %} {{ season_info.mid_season_start_2|format_date_by_locale }} {% trans "au" %} {{ season_info.mid_season_end_2|format_date_by_locale }} </th>
                    <th scope="col" class="align-middle text-center">{% trans "Haute saison" %}<br>{% trans "du" %} {{ season_info.high_season_start|format_date_by_locale }} {% trans "au" %} {{ season_info.high_season_end|format_date_by_locale }} </th>
                </tr>
            </thead>
            <tbody>
                {% for home in mobilhomes %}
                <tr>
                    <!-- Name and description -->
                    <td>
                        <strong>{{ home.name_display }}</strong><br>
                        <small>{{ home.description_display }}</small>

                        {% if home.info_pdf %}
                            <br>
                            <a href="{% static home.info_pdf %}" target="_blank" rel="noopener" class="link-info-pdf">
                                + {% trans "d'infos" %}
                            </a>
                        {% endif %}

                        {% if home.is_worker_home %}
                            <br>
                            <small class="text-muted"><em>{% trans "Réservé aux ouvriers" %}</em></small>
                        {% endif %}
                    </td>

                    <!-- Price per night -->
                    <td>
                        {% if home.night_price_mid %}
                            {{ home.night_price}} € ({% trans "basse saison" %})<br>
                            {{ home.night_price_mid}} € ({% trans "moyenne saison" %})
                        {% else %}
                            {{ home.night_price }} €
                        {% endif %}
                    </td>

                    {% if home.is_worker_home %}
                        <!-- Special case for worker mobile home: merges the 3 columns -->
                        <td colspan="3">
                            {{ home.worker_price_1p }} {% trans "€/semaine (1 pers)" %}<br>
                            {{ home.worker_price_2p }} {% trans "€/semaine (2 pers)" %}<br>
                            {{ home.worker_price_3p }} {% trans "€/semaine (3 pers)" %}
                        </td>
                    {% else %}
                        <!-- Price per week -->
                        <td>{% if home.week_low %}{{ home.week_low }} {% trans "€/semaine" %}{% else %}-{% endif %}</td>
                        <td>{% if home.week_mid %}{{ home.week_mid }} {% trans "€/semaine" %}{% else %}-{% endif %}</td>
                        <td>{% if home.week_high %}{{ home.week_high }} {% trans "€/semaine" %}{% else %}-{% endif %}</td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Notes -->
        <div class="mt-3">
            <p class="small text-muted mb-0">
                {% trans "Caution à prévoir : " %}
                <ul class="small text-muted">
                    <li>{% trans "Mobil-home" %} : {{ mobilhome_supplements.mobile_home_deposit }} €</li>
                    <li>{% trans "Ménage" %} : {{ mobilhome_supplements.cleaning_deposit }} €</li>
                </ul>
            </p>
            <p class="small text-muted">
                {% trans "Oreillers et couettes fournis (taies d’oreillers, housses de couette et draps disponibles en location à partir de" %} {{ mobilhome_supplements.bed_linen_rental }} €).
            </p>
            <p class="small text-muted">
                {% trans "Antennes TV fournies (téléviseur non inclus)." %}
            </p>
            {% if mobilhome_supplements.inventory_pdf %}
                <p class="small text-muted mb-0">
                    <a href="{% static 'docs/INVENTAIRE_TYPE.pdf' %}" target="_blank" rel="noopener" class="link-info-pdf">
                        {% trans "Voir l'inventaire des mobil-homes" %}
                    </a>
                </p>
            {% endif %}
        </div>
    </div>

</section>
{% endblock %}
